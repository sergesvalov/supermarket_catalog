<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ë–∞–∑–∞ –¶–µ–Ω</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container py-5">
        <h2 class="mb-4">üõí –ö–∞—Ç–∞–ª–æ–≥ –¶–µ–Ω</h2>
        <div class="row">
            <div class="col-md-4">
                <div class="card p-3 shadow-sm">
                    <form id="addForm">
                        <div class="mb-3">
                            <input type="text" id="name" class="form-control" placeholder="–¢–æ–≤–∞—Ä" required>
                        </div>
                        <div class="mb-3">
                            <input type="text" id="shop_name" class="form-control" placeholder="–ú–∞–≥–∞–∑–∏–Ω" required>
                        </div>
                        <div class="mb-3 input-group">
                            <input type="number" step="0.01" id="price" class="form-control" placeholder="–¶–µ–Ω–∞" required>
                            <span class="input-group-text">‚ÇΩ</span>
                        </div>
                        <button type="submit" class="btn btn-success w-100">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </form>
                </div>
            </div>
            <div class="col-md-8">
                <div id="productList"></div>
            </div>
        </div>
    </div>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        async function loadProducts() {
            const response = await fetch('/api/products');
            const products = await response.json();
            const list = document.getElementById('productList');
            list.innerHTML = products.map(p => `
                <div class="card mb-2 p-3 border-0 shadow-sm">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="m-0">${p.name}</h5>
                            <small class="text-muted">${p.shop_name}</small>
                        </div>
                        <div class="fw-bold fs-5 text-success">${p.price} ‚ÇΩ</div>
                    </div>
                </div>
            `).join('');
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã
        document.getElementById('addForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = {
                name: document.getElementById('name').value,
                shop_name: document.getElementById('shop_name').value,
                price: parseFloat(document.getElementById('price').value)
            };

            await fetch('/api/products', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            });

            e.target.reset();
            loadProducts(); // –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        loadProducts();
    </script>
</body>
</html>